<?php
/**
 * Copyright 2019-2026 ShopeX
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

namespace ThirdPartyBundle\Services\DadaCenter;

use Dingo\Api\Exception\ResourceException;
use ThirdPartyBundle\Services\DadaCenter\Api\CityCodeApi;
use ThirdPartyBundle\Services\DadaCenter\Client\DadaRequest;

class CityCodeService
{
    private $cityList = '[{"cityName":"上海","cityCode":"021"},{"cityName":"北京","cityCode":"010"},{"cityName":"合肥","cityCode":"0551"},{"cityName":"南京","cityCode":"025"},{"cityName":"苏州","cityCode":"0512"},{"cityName":"武汉","cityCode":"027"},{"cityName":"无锡","cityCode":"0510"},{"cityName":"常州","cityCode":"0519"},{"cityName":"杭州","cityCode":"0571"},{"cityName":"广州","cityCode":"020"},{"cityName":"深圳","cityCode":"0755"},{"cityName":"重庆","cityCode":"023"},{"cityName":"长沙","cityCode":"0731"},{"cityName":"成都","cityCode":"028"},{"cityName":"天津","cityCode":"022"},{"cityName":"厦门","cityCode":"0592"},{"cityName":"福州","cityCode":"0591"},{"cityName":"大连","cityCode":"0411"},{"cityName":"青岛","cityCode":"0532"},{"cityName":"哈尔滨","cityCode":"0451"},{"cityName":"济南","cityCode":"0531"},{"cityName":"郑州","cityCode":"0371"},{"cityName":"西安","cityCode":"029"},{"cityName":"宁波","cityCode":"0574"},{"cityName":"温州","cityCode":"0577"},{"cityName":"芜湖","cityCode":"0553"},{"cityName":"南通","cityCode":"0513"},{"cityName":"南昌","cityCode":"0791"},{"cityName":"石家庄","cityCode":"0311"},{"cityName":"潍坊","cityCode":"0536"},{"cityName":"嘉兴","cityCode":"0573"},{"cityName":"金华","cityCode":"0579"},{"cityName":"绍兴","cityCode":"0575"},{"cityName":"烟台","cityCode":"0535"},{"cityName":"扬州","cityCode":"0514"},{"cityName":"昆山","cityCode":"0512"},{"cityName":"佛山","cityCode":"0757"},{"cityName":"东莞","cityCode":"0769"},{"cityName":"马鞍山","cityCode":"0555"},{"cityName":"洛阳","cityCode":"0379"},{"cityName":"大理","cityCode":"0872"},{"cityName":"安庆","cityCode":"0556"},{"cityName":"亳州","cityCode":"0558"},{"cityName":"池州","cityCode":"0566"},{"cityName":"滁州","cityCode":"0550"},{"cityName":"阜阳","cityCode":"1558"},{"cityName":"湖州","cityCode":"0572"},{"cityName":"淮安","cityCode":"0517"},{"cityName":"淮北","cityCode":"0561"},{"cityName":"淮南","cityCode":"0554"},{"cityName":"黄山","cityCode":"0559"},{"cityName":"连云港","cityCode":"0518"},{"cityName":"六安","cityCode":"0564"},{"cityName":"衢州","cityCode":"0570"},{"cityName":"台州","cityCode":"0576"},{"cityName":"泰州","cityCode":"0523"},{"cityName":"铜陵","cityCode":"0562"},{"cityName":"宿迁","cityCode":"0527"},{"cityName":"宿州","cityCode":"0557"},{"cityName":"徐州","cityCode":"0516"},{"cityName":"盐城","cityCode":"0515"},{"cityName":"镇江","cityCode":"0511"},{"cityName":"巴中","cityCode":"0827"},{"cityName":"达州","cityCode":"0818"},{"cityName":"德阳","cityCode":"0838"},{"cityName":"广安","cityCode":"0826"},{"cityName":"广元","cityCode":"0839"},{"cityName":"贵阳","cityCode":"0851"},{"cityName":"昆明","cityCode":"0871"},{"cityName":"拉萨","cityCode":"0891"},{"cityName":"乐山","cityCode":"0833"},{"cityName":"丽江","cityCode":"0888"},{"cityName":"临沧","cityCode":"0883"},{"cityName":"六盘水","cityCode":"0858"},{"cityName":"泸州","cityCode":"0830"},{"cityName":"眉山","cityCode":"1833"},{"cityName":"绵阳","cityCode":"0816"},{"cityName":"南充","cityCode":"0817"},{"cityName":"内江","cityCode":"0832"},{"cityName":"攀枝花","cityCode":"0812"},{"cityName":"普洱","cityCode":"0879"},{"cityName":"曲靖","cityCode":"0874"},{"cityName":"遂宁","cityCode":"0825"},{"cityName":"雅安","cityCode":"0835"},{"cityName":"宜宾","cityCode":"0831"},{"cityName":"玉溪","cityCode":"0877"},{"cityName":"昭通","cityCode":"0870"},{"cityName":"资阳","cityCode":"0832"},{"cityName":"自贡","cityCode":"0813"},{"cityName":"遵义","cityCode":"0852"},{"cityName":"毕节","cityCode":"0857"},{"cityName":"西昌","cityCode":"0834"},{"cityName":"楚雄","cityCode":"0878"},{"cityName":"红河","cityCode":"0873"},{"cityName":"文山","cityCode":"0876"},{"cityName":"广汉","cityCode":"028"},{"cityName":"兴义","cityCode":"0859"},{"cityName":"都匀","cityCode":"0854"},{"cityName":"凯里","cityCode":"0855"},{"cityName":"西双版纳","cityCode":"0691"},{"cityName":"张家口","cityCode":"0313"},{"cityName":"泰安","cityCode":"0538"},{"cityName":"河源","cityCode":"0762"},{"cityName":"兰州","cityCode":"0931"},{"cityName":"潮州","cityCode":"0768"},{"cityName":"承德","cityCode":"0314"},{"cityName":"汕头","cityCode":"0754"},{"cityName":"秦皇岛","cityCode":"0335"},{"cityName":"茂名","cityCode":"0668"},{"cityName":"沧州","cityCode":"0317"},{"cityName":"汕尾","cityCode":"0660"},{"cityName":"梅州","cityCode":"0753"},{"cityName":"营口","cityCode":"0417"},{"cityName":"韶关","cityCode":"0751"},{"cityName":"梧州","cityCode":"0774"},{"cityName":"太原","cityCode":"0351"},{"cityName":"惠州","cityCode":"0752"},{"cityName":"湛江","cityCode":"0759"},{"cityName":"南宁","cityCode":"0771"},{"cityName":"南平","cityCode":"0599"},{"cityName":"百色","cityCode":"0776"},{"cityName":"清远","cityCode":"0763"},{"cityName":"龙岩","cityCode":"0597"},{"cityName":"莆田","cityCode":"0594"},{"cityName":"中山","cityCode":"0760"},{"cityName":"漳州","cityCode":"0596"},{"cityName":"揭阳","cityCode":"0663"},{"cityName":"咸阳","cityCode":"0910"},{"cityName":"鞍山","cityCode":"0412"},{"cityName":"贵港","cityCode":"1755"},{"cityName":"桂林","cityCode":"0773"},{"cityName":"阳江","cityCode":"0662"},{"cityName":"保定","cityCode":"0312"},{"cityName":"宝鸡","cityCode":"0917"},{"cityName":"柳州","cityCode":"0772"},{"cityName":"海口","cityCode":"0898"},{"cityName":"珠海","cityCode":"0756"},{"cityName":"沈阳","cityCode":"024"},{"cityName":"泉州","cityCode":"0595"},{"cityName":"汉中","cityCode":"0916"},{"cityName":"邯郸","cityCode":"0310"},{"cityName":"唐山","cityCode":"0315"},{"cityName":"肇庆","cityCode":"0758"},{"cityName":"长春","cityCode":"0431"},{"cityName":"三明","cityCode":"0598"},{"cityName":"邢台","cityCode":"0319"},{"cityName":"廊坊","cityCode":"0316"},{"cityName":"来宾","cityCode":"1772"},{"cityName":"宁德","cityCode":"0593"},{"cityName":"江门","cityCode":"0750"},{"cityName":"渭南","cityCode":"0913"},{"cityName":"银川","cityCode":"0951"},{"cityName":"济宁","cityCode":"0537"},{"cityName":"黄冈","cityCode":"0713"},{"cityName":"孝感","cityCode":"0712"},{"cityName":"襄阳","cityCode":"0710"},{"cityName":"宜昌","cityCode":"0717"},{"cityName":"荆州","cityCode":"0716"},{"cityName":"荆门","cityCode":"0724"},{"cityName":"新乡","cityCode":"0373"},{"cityName":"南阳","cityCode":"0377"},{"cityName":"信阳","cityCode":"0376"},{"cityName":"衡阳","cityCode":"0734"},{"cityName":"株洲","cityCode":"0733"},{"cityName":"岳阳","cityCode":"0730"},{"cityName":"赣州","cityCode":"0797"},{"cityName":"宜春","cityCode":"0795"},{"cityName":"凉山","cityCode":"0834"},{"cityName":"黔东南","cityCode":"0855"},{"cityName":"黔南","cityCode":"0854"},{"cityName":"淄博","cityCode":"0533"},{"cityName":"滨州","cityCode":"0543"},{"cityName":"包头","cityCode":"0472"},{"cityName":"临沂","cityCode":"0539"},{"cityName":"晋中","cityCode":"0354"},{"cityName":"运城","cityCode":"0359"},{"cityName":"大同","cityCode":"0352"},{"cityName":"威海","cityCode":"0631"},{"cityName":"乌海","cityCode":"0473"},{"cityName":"鄂尔多斯","cityCode":"0477"},{"cityName":"丹东","cityCode":"0415"},{"cityName":"延安","cityCode":"0911"},{"cityName":"榆林","cityCode":"0912"},{"cityName":"商洛","cityCode":"0914"},{"cityName":"石嘴山","cityCode":"0952"},{"cityName":"吴忠","cityCode":"0953"},{"cityName":"日照","cityCode":"0633"},{"cityName":"长治","cityCode":"0355"},{"cityName":"阳泉","cityCode":"0353"},{"cityName":"吕梁","cityCode":"0358"},{"cityName":"临汾","cityCode":"0357"},{"cityName":"防城港","cityCode":"0770"},{"cityName":"钦州","cityCode":"777"},{"cityName":"北海","cityCode":"779"},{"cityName":"五指山","cityCode":"1897"},{"cityName":"安阳","cityCode":"372"},{"cityName":"常德","cityCode":"736"},{"cityName":"郴州","cityCode":"735"},{"cityName":"抚州","cityCode":"794"},{"cityName":"鹤壁","cityCode":"392"},{"cityName":"黄石","cityCode":"714"},{"cityName":"吉安","cityCode":"796"},{"cityName":"济源","cityCode":"1391"},{"cityName":"焦作","cityCode":"391"},{"cityName":"景德镇","cityCode":"798"},{"cityName":"九江","cityCode":"792"},{"cityName":"开封","cityCode":"378"},{"cityName":"娄底","cityCode":"738"},{"cityName":"平顶山","cityCode":"375"},{"cityName":"萍乡","cityCode":"799"},{"cityName":"三门峡","cityCode":"398"},{"cityName":"商丘","cityCode":"370"},{"cityName":"上饶","cityCode":"793"},{"cityName":"邵阳","cityCode":"739"},{"cityName":"随州","cityCode":"722"},{"cityName":"天门","cityCode":"1728"},{"cityName":"仙桃","cityCode":"728"},{"cityName":"咸宁","cityCode":"715"},{"cityName":"湘潭","cityCode":"732"},{"cityName":"新余","cityCode":"790"},{"cityName":"许昌","cityCode":"374"},{"cityName":"益阳","cityCode":"737"},{"cityName":"鹰潭","cityCode":"701"},{"cityName":"永州","cityCode":"746"},{"cityName":"张家界","cityCode":"744"},{"cityName":"常熟","cityCode":"512"},{"cityName":"太仓","cityCode":"512"},{"cityName":"临安","cityCode":"571"},{"cityName":"黔西南","cityCode":"0859"},{"cityName":"辛集","cityCode":"311"},{"cityName":"江阴","cityCode":"510"},{"cityName":"胶州","cityCode":"532"},{"cityName":"彭州","cityCode":"28"},{"cityName":"晋江","cityCode":"595"},{"cityName":"清镇","cityCode":"851"},{"cityName":"仁怀","cityCode":"852"},{"cityName":"普宁","cityCode":"663"},{"cityName":"安岳县","cityCode":"028"},{"cityName":"夹江县","cityCode":"0833"},{"cityName":"渠县","cityCode":"818"},{"cityName":"宣汉","cityCode":"818"},{"cityName":"仁寿县","cityCode":"28"},{"cityName":"阆中","cityCode":"817"},{"cityName":"分宜县","cityCode":"790"},{"cityName":"新昌县","cityCode":"575"},{"cityName":"孝义","cityCode":"358"},{"cityName":"兰溪","cityCode":"579"},{"cityName":"武义县","cityCode":"579"},{"cityName":"盘州","cityCode":"858"},{"cityName":"洪湖","cityCode":"716"},{"cityName":"浦江","cityCode":"579"},{"cityName":"荣县","cityCode":"813"},{"cityName":"蕲春","cityCode":"713"},{"cityName":"麻城","cityCode":"713"},{"cityName":"安陆","cityCode":"712"},{"cityName":"霞浦","cityCode":"593"},{"cityName":"福鼎","cityCode":"593"},{"cityName":"英德","cityCode":"763"},{"cityName":"广宁","cityCode":"758"},{"cityName":"红安","cityCode":"713"},{"cityName":"汉川","cityCode":"712"},{"cityName":"德清","cityCode":"572"},{"cityName":"义乌","cityCode":"579"},{"cityName":"长兴","cityCode":"572"},{"cityName":"景洪","cityCode":"691"},{"cityName":"罗平","cityCode":"874"},{"cityName":"蒙自","cityCode":"873"},{"cityName":"个旧","cityCode":"873"},{"cityName":"建水","cityCode":"873"},{"cityName":"弥勒","cityCode":"873"},{"cityName":"宣威","cityCode":"874"},{"cityName":"冷水江","cityCode":"738"},{"cityName":"新化","cityCode":"738"},{"cityName":"应城","cityCode":"712"},{"cityName":"峨眉山","cityCode":"833"},{"cityName":"林州","cityCode":"372"},{"cityName":"张北","cityCode":"313"},{"cityName":"嵊州","cityCode":"575"},{"cityName":"诸暨","cityCode":"575"},{"cityName":"定州","cityCode":"312"},{"cityName":"绥阳县","cityCode":"852"},{"cityName":"武冈","cityCode":"739"},{"cityName":"营山县","cityCode":"817"},{"cityName":"南县","cityCode":"737"},{"cityName":"江安县","cityCode":"831"},{"cityName":"犍为县","cityCode":"833"},{"cityName":"思南县","cityCode":"856"},{"cityName":"临泉","cityCode":"558"},{"cityName":"什邡","cityCode":"838"},{"cityName":"高安","cityCode":"795"},{"cityName":"吉首","cityCode":"743"},{"cityName":"永安","cityCode":"598"},{"cityName":"福安","cityCode":"593"},{"cityName":"沁阳","cityCode":"391"},{"cityName":"天长","cityCode":"550"},{"cityName":"德庆","cityCode":"758"},{"cityName":"汾阳","cityCode":"358"},{"cityName":"监利","cityCode":"716"},{"cityName":"全椒","cityCode":"550"},{"cityName":"泗洪","cityCode":"527"},{"cityName":"明光","cityCode":"550"},{"cityName":"泗阳","cityCode":"527"},{"cityName":"东至县","cityCode":"566"},{"cityName":"青阳","cityCode":"566"},{"cityName":"盱眙","cityCode":"517"},{"cityName":"温岭","cityCode":"576"},{"cityName":"东阳","cityCode":"579"},{"cityName":"邳州","cityCode":"516"},{"cityName":"禹州市","cityCode":"374"},{"cityName":"台山市","cityCode":"750"},{"cityName":"伊川县","cityCode":"379"},{"cityName":"辉县市","cityCode":"373"},{"cityName":"长葛市","cityCode":"374"},{"cityName":"东海县","cityCode":"518"},{"cityName":"沭阳县","cityCode":"527"},{"cityName":"无为市","cityCode":"0553"},{"cityName":"南陵县","cityCode":"0553"},{"cityName":"澳门","cityCode":"853"},{"cityName":"资中县","cityCode":"0832"},{"cityName":"苍溪县","cityCode":"0839"},{"cityName":"南溪区","cityCode":"0831"},{"cityName":"安乡县","cityCode":"0736"},{"cityName":"上高县","cityCode":"0795"},{"cityName":"安平县","cityCode":"0318"},{"cityName":"沈丘县","cityCode":"0394"},{"cityName":"西华县","cityCode":"0394"},{"cityName":"澧县","cityCode":"0376"},{"cityName":"鄱阳县","cityCode":"0793"},{"cityName":"崇仁县","cityCode":"0794"},{"cityName":"永康市","cityCode":"0579"},{"cityName":"仙居县","cityCode":"0576"},{"cityName":"玉环市","cityCode":"0576"},{"cityName":"临海市","cityCode":"0576"},{"cityName":"平果市","cityCode":"0776"},{"cityName":"招远市","cityCode":"0535"},{"cityName":"仙游县","cityCode":"0594"},{"cityName":"泰兴市","cityCode":"0523"},{"cityName":"宁强县","cityCode":"0916"},{"cityName":"略阳县","cityCode":"0916"},{"cityName":"城固县","cityCode":"0916"},{"cityName":"洋县","cityCode":"0916"},{"cityName":"任丘","cityCode":"0317"},{"cityName":"新蔡县","cityCode":"0396"},{"cityName":"长宁县","cityCode":"0831"},{"cityName":"西充县","cityCode":"0817"},{"cityName":"望都县","cityCode":"0312"},{"cityName":"永新县","cityCode":"0796"},{"cityName":"常山县","cityCode":"0570"},{"cityName":"龙游县","cityCode":"570"},{"cityName":"开平市","cityCode":"0750"},{"cityName":"鹿邑县","cityCode":"0394"},{"cityName":"武胜县","cityCode":"0826"},{"cityName":"岳池县","cityCode":"0826"},{"cityName":"扬中市","cityCode":"0511"},{"cityName":"汉寿县","cityCode":"0736"},{"cityName":"桂阳县","cityCode":"0735"},{"cityName":"建湖县","cityCode":"0515"},{"cityName":"阜宁县","cityCode":"0515"},{"cityName":"句容市","cityCode":"0511"},{"cityName":"兴化市","cityCode":"0523"},{"cityName":"岳阳县","cityCode":"0730"},{"cityName":"开江县","cityCode":"0818"},{"cityName":"涟源市","cityCode":"0738"},{"cityName":"华容县","cityCode":"0730"},{"cityName":"来安县","cityCode":"0550"},{"cityName":"双峰县","cityCode":"0738"},{"cityName":"永丰县","cityCode":"0796"},{"cityName":"颍上县","cityCode":"0558"},{"cityName":"道县","cityCode":"0746"},{"cityName":"江华瑶族自治县","cityCode":"0746"},{"cityName":"隆回县","cityCode":"0739"},{"cityName":"邵东市","cityCode":"1433"},{"cityName":"京山市","cityCode":"0724"},{"cityName":"三沙","cityCode":"460300"}]';
    /**
     * 获取城市列表信息
     * @param string $companyId 企业Id
     * @return mixed 城市列表
     */
    public function list($companyId)
    {
        $cityCodeApi = new CityCodeApi('');
        $dadaClient = new DadaRequest($companyId, $cityCodeApi);
        $resp = $dadaClient->makeRequest();
        if ($resp->status == 'fail') {
            throw new ResourceException($resp->msg);
        }
        return $resp->result;
    }

    /**
     * 获取本地城市列表
     * @return string 城市列表
     */
    public function getLocalCityCode()
    {
        // FIXME: check performance
        return $this->cityList;
    }
}
